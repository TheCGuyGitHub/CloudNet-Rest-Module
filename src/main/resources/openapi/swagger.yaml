openapi: 3.1.0
info:
  description: >
    CloudNet's rest API version 3 is the next generation in CloudNet's rest
    history.
    
    
    In order to access rest API v3 you will have to authenticate yourself using basic auth.
    To create a basic auth user use the `rest user create <id> <password>` command on your cloudnet node.
    After authenticating with basic auth on `/auth` you will get a bearer jwt access token that must be used for further
    requests to the api. For further information about the response take a look at the `/auth` endpoint.
  version: '3'
  title: CloudNet
  contact:
    name: CloudNet
    url: https://cloudnetservice.eu
  license:
    name: Apache license, version 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
servers:
  - url: '{protocol}://{host}:{port}/api/v3/'
    variables:
      protocol:
        enum:
          - http
          - https
        default: https
      host:
        default: 127.0.0.1
      port:
        default: '2812'
security:
  - bearerAuth: [ ]
externalDocs:
  description: Contact us on Discord
  url: https://discord.cloudnetservice.eu
tags:
  - name: Session Management
    description: Management of the user's rest api authentication and session
  - name: Rest Management
    description: Management for rest user creation and modification
  - name: Node
    description: Access to some node functions the request is sent to
  - name: Cluster
    description: Management of the cluster the current node is part of
  - name: Database
    description: Management of the cloudnet internal database
  - name: Groups
    description: Management of the cloudnet group system
  - name: Player
    description: Management of cloudnet players
  - name: Tasks
    description: Management of the cloudnet task system
  - name: Services
    description: Management of the services which are running in the cluster
  - name: Template Storage
    description: Management of the templates
  - name: Templates
    description: Management of the templates
  - name: Service Versions
    description: Management of service versions
  - name: Modules
    description: Management of the modules
paths:
  /auth:
    post:
      security:
        - basicAuth: [ ]
      tags:
        - Session Management
      summary: Authenticate a user at the rest endpoint
      description: >
        Authenticates a rest user and issues a JWT auth token for further requests.
      responses:
        '200':
          description: >
            Successfully authenticated the user at the rest endpoint. The
            resulting json object will contain the bearer token for further
            requests to the endpoint.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JwtToken'
        '400':
          $ref: '#/components/responses/Problem'
          description: >-
            If the auth header is missing or not containing basic auth
            credentials
        '401':
          $ref: '#/components/responses/Problem'
          description: If the provided authentication information is invalid
  /auth/refresh:
    post:
      tags:
        - Session Management
      summary: Refreshes an auth token
      description: >
        Invalidates the current auth and refresh token that is used when calling
        the route and issues new ones to be used afterwards.
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JwtToken'
          description: The auth token was refreshed successfully.
        '400':
          $ref: '#/components/responses/Problem'
          description: >-
            In case an access token instead of a refresh token is used to call
            the route
        '401':
          $ref: '#/components/responses/Problem'
          description: If the provided refresh token is invalid
  /auth/verify:
    post:
      tags:
        - Session Management
      summary: Checks if an auth token is still valid
      description: |
        This route can be used to check if the given auth or refresh token is still 
        valid and how long
      responses:
        '200':
          description: The auth token is still valid
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: The type of token used to call the route
                    enum:
                      - access
                      - refresh
                  expiresAt:
                    type: integer
                    description: The epoch milli when the used token is going to expire
                    examples:
                      - 1697724270214
        '401':
          $ref: '#/components/responses/Problem'
          description: The provided auth token is no longer valid
  /auth/revoke:
    post:
      tags:
        - Session Management
      summary: Revokes an auth token and the corresponding refresh token
      description: |
        This route can be used to revoke an auth and a refresh token by calling it
        with either of these token types.
      responses:
        '204':
          description: The auth token was removed successfully
        '401':
          $ref: '#/components/responses/Problem'
          description: The provided auth token is no longer valid
  /user:
    get:
      tags:
        - Rest Management
      summary: Lists all existing rest users
      description: |
        Lists all registered rest users.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:user_read`
        
          - `cloudnet_rest:user_get_all`
      operationId: user
      responses:
        '200':
          description: All existing rest users
          content:
            application/json:
              schema:
                properties:
                  users:
                    type: array
                    items:
                      $ref: '#/components/schemas/RestUser'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    post:
      tags:
        - Rest Management
      summary: Create a new rest user
      description: |
        Creates a new rest user based on the supplied request body. While creating a user is possible without
        the `global:admin` scope, it is not possible to add scopes to the user.
        
        One of the following scopes is needed to execute the request:
                 - `cloudnet_rest:user_write`
        
                 - `cloudnet_rest:user_create`
      operationId: user
      requestBody:
        required: true
        description: The rest user to create
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/RestUser'
                - properties:
                    password:
                      type: string
                      examples:
                        - SuperSecurePassword
      responses:
        '201':
          description: User was created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestUser'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /user/{uniqueId}:
    parameters:
      - name: uniqueId
        in: path
        required: true
        description: The id of the rest user
        schema:
          type: string
    get:
      tags:
        - Rest Management
      summary: Get information about a rest user
      description: |
        Gets information about an already existing rest user.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:user_read`
        
          - `cloudnet_rest:user_get`
      responses:
        '200':
          description: The requested user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestUser'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
    put:
      tags:
        - Rest Management
      summary: Updates an existing rest user.
      description: |
        Updates the given rest user. At least one of the properties have to be updated.
        
        If the user is not updating himself the scope `global:admin` is needed too.
        Furthermore if scopes are to be modified using the request `global:admin` is needed, regardless whether the user
        is editing himself or somebody else.
        
        The following scope is required:
          - `cloudnet_rest:user_write`
        
          - `cloudnet_rest:user_update`
      responses:
        '200':
          description: The updated user.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestUser'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
      requestBody:
        required: true
        description: The properties of the rest user to update. At least one is required.
        content:
          application/json:
            schema:
              anyOf:
                - properties:
                    password:
                      type: string
                      examples:
                        - SuperSecurePassword
                - properties:
                    id:
                      type: string
                      examples:
                        - playo
                - properties:
                    scopes:
                      type: array
                      items:
                        type: string
                      examples:
                        - [ "global:admin", "cloudnet_rest:cluster_read" ]
    delete:
      tags:
        - Rest Management
      summary: Delete a rest user
      description: |
        Deletes an existing rest user by its unique id.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:user_write`
        
          - `cloudnet_rest:user_delete`
      responses:
        '204':
          description: The requested user was deleted
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /cluster:
    get:
      tags:
        - Cluster
      summary: Lists all nodes
      description: |
        Lists all nodes which are registered in the node. This includes nodes
        which are currently not connected to the node. If they are not connected
        available will be `false` and the `nodeInfoSnapshot` will be null.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_read`
         - `cloudnet_rest:cluster_node_list`
      operationId: cluster
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  nodes:
                    type: array
                    items:
                      $ref: '#/components/schemas/NodeServer'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    put:
      requestBody:
        required: true
        description: The new node configuration entry.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NetworkClusterNode'
      tags:
        - Cluster
      summary: Updates a node
      description: |
        Changes the configuration of a specific node in the local node's config
        file. The update will be pushed live to the node cluster settings. That
        does not mean that the node tries to connect to the updated node.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_write`
        
         - `cloudnet_rest:cluster_node_update`
      operationId: clusterUpdate
      responses:
        '204':
          description: The node was updated successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
    post:
      requestBody:
        required: true
        description: The node configuration entry.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NetworkClusterNode'
      tags:
        - Cluster
      summary: Creates a new node
      description: |
        Creates a node in the node's local configuration and updates it live to
        the node cluster settings. That does not mean that the node tries to
        connect to the newly registered node.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_write`
         - `cloudnet_rest:cluster_node_create`
      operationId: clusterCreate
      responses:
        '201':
          description: The new node was created successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /cluster/{uniqueId}:
    parameters:
      - name: uniqueId
        in: path
        required: true
        description: The id of the target node
        schema:
          type: string
    get:
      tags:
        - Cluster
      summary: Get detail information of a specific node
      description: |
        Get the detailed information about the node that is associated with the given node id.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_read`
        
         - `cloudnet_rest:cluster_node_get`
      operationId: clusterInfo
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeServer'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
    delete:
      tags:
        - Cluster
      summary: Deletes a node configuration entry
      description: |
        Deletes a node from the config of the local node and pushes the changes
        live to the local cluster settings. That does not mean that the node
        gets disconnected.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_write`
        
         - `cloudnet_rest:cluster_node_delete`
      operationId: clusterDelete
      responses:
        '204':
          description: The node configuration entry was deleted successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /cluster/{uniqueId}/command:
    parameters:
      - name: uniqueId
        in: path
        required: true
        description: The id of the target node
        schema:
          type: string
    post:
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                command:
                  type: string
                  examples:
                    - 'service Lobby-1 delete'
      tags:
        - Cluster
      summary: Sends a command to the given node
      description: |
        Sends a command to a specific node in the cluster.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:cluster_write`
        
         - `cloudnet_rest:cluster_node_command`
      operationId: clusterCommand
      responses:
        '200':
          description: The command was executed successfully
          content:
            application/json:
              schema:
                properties:
                  lines:
                    type: array
                    items:
                      type: string
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'

  /node:
    get:
      security:
        - bearerAuth: [ ]
      tags:
        - Node
      summary: Node info
      description: |
        Information about the node the rest listener belongs to.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_read`

         - `cloudnet_rest:node_info`
      operationId: generalInfo
      responses:
        '200':
          description: Information about the node the request was sent to
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeInfo'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /node/ping:
    get:
      security:
        - basicAuth: [ ]
        - bearerAuth: [ ]
      tags:
        - Node
      summary: Node ping
      description: |
        Tests whether the rest api is available and is responding

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_read`

         - `cloudnet_rest:node_ping`
      operationId: nodePing
      responses:
        '204':
          description: The rest api is running and responding
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /node/liveConsole:
    get:
      tags:
        - Node
      summary: Live console
      description: >
        Upgrades the connection to a web socket connection and sends all new
        command

        lines received to the connection.


        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_read`

         - `cloudnet_rest:node_live_console`
      responses:
        '101':
          description: Switching the protocol to a websocket
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /node/reload:
    parameters:
      - name: type
        in: query
        required: false
        description: The reload type
        schema:
          type: string
          enum:
            - all
            - config
          default: all
    post:
      tags:
        - Node
      summary: Reloads the node the request is sent to
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_write`

         - `cloudnet_rest:node_reload`
      responses:
        '204':
          description: "The node was reloaded."
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /node/config:
    get:
      tags:
        - Node
      summary: Get the current configuration file of the node the request is sent to
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_read`

         - `cloudnet_rest:node_config_get`
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeConfiguration'
          description: The node configuration that was requested
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    put:
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NodeConfiguration'
      tags:
        - Node
      summary: Updates the configuration file of the node the request is sent to
      description: |
        To add/remove a node from the configuration please use the cluster 
        routes to add/remove a node.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:node_write`

         - `cloudnet_rest:node_config_update`
      responses:
        '204':
          description: The node configuration was updated.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database:
    get:
      tags:
        - Database
      summary: Lists all database names
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_read`

         - `cloudnet_rest:database_list`
      operationId: listDatabase
      responses:
        '200':
          description: All database names.
          content:
            application/json:
              schema:
                properties:
                  databaseNames:
                    type: array
                    items:
                      type: string
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}:
    parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
    post:
      requestBody:
        required: true
        description: The document value to insert
        content:
          application/json:
            schema:
              type: object
              properties:
                key:
                  type: string
                  examples:
                    - Signs 0utplayyyy
                document:
                  type: object
                  examples:
                    - Name: Peter
      tags:
        - Database
      summary: Creates a new document in a database
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_write`

         - `cloudnet_rest:database_insert`
      responses:
        '201':
          description: The document was inserted into the database
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    delete:
      parameters:
        - name: key
          in: query
          required: true
          description: The key to delete from a database
          schema:
            type: string
      tags:
        - Database
      summary: Deletes a document from the database
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_write`

         - `cloudnet_rest:database_delete`
      responses:
        '204':
          description: Successful deletion of the entry from the database.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/clear:
    post:
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      summary: Clears a database
      description: |
        Clears the content of the given database.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_write`

         - `cloudnet_rest:database_clear`
      responses:
        '204':
          description: The database was cleared.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/keys:
    get:
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      summary: Get all keys in a database
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_read`

         - `cloudnet_rest:database_keys`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  keys:
                    type: array
                    items:
                      type: string
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/count:
    get:
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      summary: Get the document count of a database
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_read`

         - `cloudnet_rest:database_count`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    examples:
                      - 5
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/contains:
    get:
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: key
          in: query
          required: true
          description: The key to check for
          schema:
            type: string
      summary: Checks if the provided database contains a specific key
      description: |
        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_read`

         - `cloudnet_rest:database_contains`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: boolean
                    examples:
                      - true
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/get:
    get:
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: key
          in: query
          required: true
          schema:
            type: string
      summary: Get a specific document from a database
      description: |
        Get the document out of the provided database by using the provided
        key.

        One of the following scopes is needed to execute the request:
         - `cloudnet_rest:database_read`

         - `cloudnet_rest:database_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: object
                    examples:
                      - Name: Peter
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /database/{name}/find:
    get:
      requestBody:
        required: true
        description: Defines the search filter to get the documents
        content:
          application/json:
            schema:
              oneOf:
                - type: object
                  examples:
                    - Signs: 0utplayyyy
      tags:
        - Database
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      summary: Get a specific document from a database
      description: >
        Gets all documents out of the provided database, by using the provided
        search filter.


        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:database_read`

          - `cloudnet_rest:database_find`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  examples:
                    - Name: Peter
                    - LastName: Parker
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /group:
    post:
      requestBody:
        required: true
        description: The json data representing the group to create or update
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupConfiguration'
      tags:
        - Groups
      summary: Creates a new group or updates an already existing one
      description: |
        Creates a new group if there is no other group known with the provided name. If there is a group known then the known group is updated using the provided data.
        
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:group_write`

          - `cloudnet_rest:group_create`
      responses:
        '201':
          description: The group was created.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    get:
      tags:
        - Groups
      summary: Lists all groups that are known by the node handling the request
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:group_read`

          - `cloudnet_rest:group_list`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  groups:
                    type: array
                    items:
                      $ref: '#/components/schemas/GroupConfiguration'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /group/{name}:
    parameters:
      - name: name
        in: path
        required: true
        description: The name of the group to retrieve
        schema:
          type: string
    get:
      tags:
        - Groups
      summary: Get a group configuration using the given name
      description: |
        Get a group configuration using the name given as path parameter. The group name is case-sensitive.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:group_read`

          - `cloudnet_rest:group_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupConfiguration'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no group with the provided name.
          $ref: '#/components/responses/Problem'
    delete:
      tags:
        - Groups
      summary: Deletes the task with the provided name
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:group_write`

          - `cloudnet_rest:group_delete`
      responses:
        '204':
          description: The group was deleted.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no group with the provided name.
          $ref: '#/components/responses/Problem'
  /player/registeredCount:
    get:
      tags:
        - Player
      summary: Get the number of registered players
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_read`
        
          - `cloudnet_bridge:player_registered_count`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - properties:
                      registeredCount:
                        type: integer
                        examples:
                          - 100
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /player/onlineCount:
    get:
      tags:
        - Player
      summary: Get the number of online players
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_read`

          - `cloudnet_bridge:player_online_count`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - properties:
                      onlineCount:
                        type: integer
                        examples:
                          - 10
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /player/online:
    parameters:
      - name: limit
        in: query
        required: false
        description: The maximum amount of players with which the API responds
        examples:
          limitTen:
            summary: Limit the response to 10 players
            value: 10
        schema:
          type: integer
          minimum: 1
          default: 10
          maximum: 25
      - name: offset
        in: query
        required: false
        description: The amount of players to skip when responding
        examples:
          skipTen:
            summary: Skip the first 10 players
            value: 10
        schema:
          type: integer
          minimum: 0
          default: 0
      - name: sort
        in: query
        required: false
        description: Sorts the players by their name
        examples:
          sortAsc:
            summary: The players will be sorted in ascending order by their name
            value: asc
          sortDesc:
            summary: The players will be sorted in descending order by their name
            value: desc
        schema:
          type: string
          enum:
            - asc
            - desc
          default: asc
    get:
      tags:
        - Player
      summary: Get a list of online players based on the query parameters
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_read`
        
          - `cloudnet_bridge:player_get_bulk`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  onlinePlayers:
                    type: array
                    items:
                      $ref: '#/components/schemas/CloudPlayer'
          headers:
            X-Total-Count:
              schema:
                type: integer
              description: The total count of players that are online
            X-Result-Count:
              schema:
                type: integer
              description: The count of results returned in this response
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to get
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
    get:
      tags:
        - Player
      summary: Get a player by his unique id or name
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_read`

          - `cloudnet_bridge:player_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CloudPlayer'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no player with the provided identifier.
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/exists:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
    get:
      tags:
        - Player
      summary: Checks if a specific player is registered
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_read`

          - `cloudnet_bridge:player_exists`
      responses:
        '204':
          description: OK
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/connectService:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
      - name: target
        in: query
        required: true
        description: The name of the service to connect the player to.
        schema:
          type: string
        examples:
          serviceConnect:
            summary: Example to connect the player to a service called `SkyWars-1`
            value: SkyWars-1
    post:
      tags:
        - Player
      summary: Connect a specific player to a specific service.
      description: |
        Connects the given player to the specified service.
        
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_connect_service`
      responses:
        '204':
          description: The request to connect the player was sent.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/connect:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
      - name: target
        in: query
        required: true
        description: |
          The name of the task / group to connect the player to.
          Use `type` to determine whether the target is a group or a task.
        schema:
          type: string
        examples:
          taskConnect:
            summary: Example to connect the player to a task called `SkyWars`
            value: SkyWars
          groupConnect:
            summary: Example to connect the player to a group called `Fallbacks`
            value: Fallbacks
      - name: serverSelector
        in: query
        required: true
        description: |
          The server selector determines which service from the given task / group to connect to.
        schema:
          type: string
          enum:
            - LOWEST_PLAYERS
            - HIGHEST_PLAYERS
            - RANDOM
        examples:
          lowestPlayers:
            summary: Example to connect the player to the service of the task / group with the lowest players.
            value: LOWEST_PLAYERS
      - name: type
        in: query
        required: true
        description: |
          The type that determines whether the given target is a task or a group.
        schema:
          type: string
          enum:
            - TASK
            - GROUP
        examples:
          groupConnect:
            summary: The given target is a group.
            value: GROUP
    post:
      tags:
        - Player
      summary: Connects a player to a given task or group.
      description: |
        Connects the given player to the given task or group based on the given target & type.

        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_connect_group_task`
      responses:
        '204':
          description: The request to connect the player was sent.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'

  /player/online/{identifier}/connectFallback:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
    post:
      tags:
        - Player
      summary: Connects a given player to a fallback service.
      description: |
        Connects the given player to any fallback service that matches the requirements.
        
        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_connect_fallback`
      responses:
        '204':
          description: The request to connect the player was sent.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/kick:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
    post:
      tags:
        - Player
      summary: Kicks a given player from the network.
      description: |
        Kicks the given player from the whole network.

        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_disconnect`
      requestBody:
        description: The body containg the message to kick the player with.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                kickMessage:
                  type: string
      responses:
        '204':
          description: The request to kick the player was sent.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/sendChat:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
    post:
      tags:
        - Player
      summary: Sends a chat message to a given player.
      description: |
        Sends the given chat message to the given player.

        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_send_chat`
      requestBody:
        description: The body containg the chat message to send to the player.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                chatMessage:
                  type: string
      responses:
        '204':
          description: The chat message was sent to the player.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /player/online/{identifier}/command:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the player to check for
        examples:
          playerId:
            value: bcc582ed-494d-4b93-86cb-b58564651a26
          playerName:
            value: 0utplayyyy
        schema:
          type: string
      - name: redirectToServer
        in: query
        required: false
        description: Whether to redirect the command to the downstream service if the command is not available on the proxy.
        schema:
          type: boolean
    post:
      tags:
        - Player
      summary: Executes a given command for a player.
      description: |
        Executes the given command for the given player.

        One of the following scopes is needed to execute the request:
          - `cloudnet_bridge:player_write`
        
          - `cloudnet_bridge:player_send_command`
      requestBody:
        description: The body containg the command to execute for the player. Its mandatory to **not** have a slash at the start of the command.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                command:
                  type: string
      responses:
        '204':
          description: The command was executed by the player
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /task:
    post:
      requestBody:
        required: true
        description: The json data representing the task to create or update
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceTask'
      tags:
        - Tasks
      summary: Creates a new task or updates an already existing one
      description: |
        Creates a new task if there is no other task known with the provided name. If there is a task known then the known task is updated using the provided data.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:task_write`

          - `cloudnet_rest:task_create`
      responses:
        '204':
          description: The task was created successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    get:
      tags:
        - Tasks
      summary: Lists all tasks that are known by the node handling the request
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:task_read`

          - `cloudnet_rest:task_list`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  tasks:
                    type: array
                    items:
                      $ref: '#/components/schemas/ServiceTask'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /task/{name}:
    parameters:
      - name: name
        in: path
        required: true
        description: The name of the task to retrieve
        schema:
          type: string
    get:
      tags:
        - Tasks
      summary: Get a service task using the given name
      description: |
        Get a service task using the name given as path parameter. The task name is case-sensitive.

        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:task_read`

          - `cloudnet_rest:task_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceTask'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no task with the provided name.
          $ref: '#/components/responses/Problem'
    delete:
      tags:
        - Tasks
      summary: Deletes the task with the provided name
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:task_write`

          - `cloudnet_rest:task_delete`
      responses:
        '204':
          description: The task was deleted successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no task with the provided name.
          $ref: '#/components/responses/Problem'
  /service:
    get:
      tags:
        - Services
      summary: Lists all known services
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_read`

          - `cloudnet_rest:service_list`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  services:
                    type: array
                    items:
                      $ref: '#/components/schemas/ServiceInfoSnapshot'
          description: Successful listing of services.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
        examples:
          serviceName:
            value: Lobby-1
            summary: Request with a service name
          serviceId:
            value: 62b37d32-3305-475a-bf26-9abee4b0b90f
            summary: Request with a service id
    get:
      tags:
        - Services
      summary: Shows a specific service if it's exists
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_read`

          - `cloudnet_rest:service_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceInfoSnapshot'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
    delete:
      tags:
        - Services
      summary: Deletes a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`
        
          - `cloudnet_rest:service_delete`
      responses:
        '204':
          description: The service was deleted
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/deleteFiles:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
        examples:
          serviceName:
            value: Lobby-1
            summary: Request with a service name
          serviceId:
            value: 62b37d32-3305-475a-bf26-9abee4b0b90f
            summary: Request with a service id
    delete:
      tags:
        - Services
      summary: Deletes all files of a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`
        
          - `cloudnet_rest:service_delete_files`
        
        WARNING: This will delete files of static services too.
      responses:
        '204':
          description: The services files were deleted
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/lifecycle:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
        examples:
          serviceName:
            value: Lobby-1
            summary: Request with a service name
          serviceId:
            value: 62b37d32-3305-475a-bf26-9abee4b0b90f
            summary: Request with a service id
      - name: target
        in: query
        required: true
        description: The target service lifecycle
        schema:
          type: string
          enum:
            - start
            - stop
            - restart
    patch:
      tags:
        - Services
      summary: Updates the lifecycle of a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_lifecycle`
      responses:
        '204':
          description: The service lifecycle was changed
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/include:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
      - name: type
        in: query
        required: true
        description: The type of inclusion to include
        schema:
          type: string
          enum:
            - templates
            - inclusions
    post:
      tags:
        - Services
      summary: Includes a specific type of inclusion added to a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_include`
      responses:
        '204':
          description: All waiting components of the given type were included.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/deployResources:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
      - name: remove
        in: query
        required: false
        description: If the deployments should be removed afterwards
        schema:
          type: boolean
          default: true
    post:
      tags:
        - Services
      summary: Deploys all waiting deployments of a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_deploy_resources`
      responses:
        '204':
          description: All deployments were executed
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/logLines:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
    get:
      tags:
        - Services
      summary: Get the cached log lines of a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_read`

          - `cloudnet_rest:service_log_lines`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  lines:
                    type: array
                    items:
                      type: string
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/liveLog:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
    get:
      tags:
        - Services
      summary: Live console of a service
      description: >
        Upgrades the connection to a web socket connection and sends all new log
        lines

        received to the connection.


        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_read`

          - `cloudnet_rest:service_live_log`
      responses:
        '101':
          description: Switching to websockets.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id running on this node.
          $ref: '#/components/responses/Problem'
  /service/create/serviceConfig:
    post:
      parameters:
        - name: start
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Whether the created service should be started
      tags:
        - Services
      summary: Creates a new service based on a service configuration
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_create_service_config`
      requestBody:
        required: true
        description: >
          The service configuration to create the new service from
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceConfiguration'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceCreateResult'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /service/create/task:
    post:
      parameters:
        - name: start
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Whether the created service should be started
      tags:
        - Services
      summary: Creates a new service based on a service task
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_create_task`
      requestBody:
        required: true
        description: >
          The service task to create the new service from
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceTask'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceCreateResult'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /service/create/taskName:
    post:
      tags:
        - Services
      summary: Creates a new service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_create_task_name`
      requestBody:
        required: true
        content:
          application/json:
            schema:
              properties:
                taskName:
                  type: string
                  examples:
                    - Lobby
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceCreateResult'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /service/{identifier}/add/template:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
      - name: flush
        in: query
        required: false
        description: >
          Whether the template should be included to the service after adding it
        schema:
          type: boolean
          default: false
    post:
      requestBody:
        required: true
        description: The template to add to the service
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceTemplate'
      tags:
        - Services
      summary: Adds a template to a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_add_template`
      responses:
        '204':
          description: The template was added to the service
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/add/deployment:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
      - name: flush
        in: query
        required: false
        description: >
          Whether the deployment should be included to the service after adding it
        schema:
          type: boolean
          default: false
    post:
      requestBody:
        required: true
        description: The deployment to add to the service
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceDeployment'
      tags:
        - Services
      summary: Adds a deployment to a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_add_deployment`
      responses:
        '204':
          description: The deployment was added to the service
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/add/inclusion:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
      - name: flush
        in: query
        required: false
        description: >
          Whether the inclusion should be included to the service after adding it
        schema:
          type: boolean
          default: false
    post:
      requestBody:
        required: true
        description: The inclusion to add to the service
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceRemoteInclusion'
      tags:
        - Services
      summary: Adds an inclusion to a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_add_inclusion`
      responses:
        '204':
          description: The inclusion was added to the service
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /service/{identifier}/command:
    parameters:
      - name: identifier
        in: path
        required: true
        description: The name or unique id of the service
        schema:
          type: string
    post:
      requestBody:
        required: true
        description: The command to execute on the service
        content:
          application/json:
            schema:
              type: object
              properties:
                command:
                  type: string
                  examples:
                    - whitelist on
      tags:
        - Services
      summary: Executes the specified command on a service
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_write`

          - `cloudnet_rest:service_send_commands`
      responses:
        '204':
          description: The command was executed on the service
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: There is no service with the provided name / id.
          $ref: '#/components/responses/Problem'
  /templateStorage:
    get:
      tags:
        - Template Storage
      summary: Shows every available template storage
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_storage_read`

          - `cloudnet_rest:template_storage_list`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  storages:
                    type: array
                    items:
                      type: string
                    examples:
                      - local
                      - ftp
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /templateStorage/{storage}/templates:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          description: The name of the template storage
          schema:
            type: string
      tags:
        - Template Storage
      summary: List every template in the given storage
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_storage_read`

          - `cloudnet_rest:template_storage_template_list`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  templates:
                    type: array
                    items:
                      $ref: '#/components/schemas/ServiceTemplate'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file/download:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          schema:
            type: string
          required: true
      tags:
        - Templates
      summary: Download a file from the specified template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_file_download`
      responses:
        '200':
          description: OK
          headers:
            Content-Disposition:
              description: |
                A header indicating that the content is expected to be displayed
                as an attachment, that is downloaded and saved locally.
              style: simple
              schema:
                type: string
          content:
            application/octet-stream:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: |
            The path requested doesn't exist in the template or is a directory
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file/info:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          schema:
            type: string
          required: true
      tags:
        - Templates
      summary: Get information about a path in a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_file_info`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileInfo'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The path requested doesn't exist in the template
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file/exists:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          schema:
            type: string
          required: true
      tags:
        - Templates
      summary: Checks whether a file/directory exists at the specified path
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_file_exists`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  exists:
                    type: boolean
                    examples:
                      - true
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/download:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Download a template as a zip file
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_download`
      responses:
        '200':
          description: OK
          headers:
            Content-Disposition:
              description: |
                A header indicating that the content is expected to be displayed
                as an attachment, that is downloaded and saved locally.
              style: simple
              schema:
                type: string
          content:
            application/zip:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/exists:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Checks whether a template exists in the specified storage
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_exists`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  exists:
                    type: boolean
                    examples:
                      - true
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/directory/list:
    get:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: directory
          in: query
          required: false
          schema:
            type: string
            default: ''
        - name: deep
          in: query
          required: false
          schema:
            type: boolean
            default: false
      tags:
        - Templates
      summary: Lists all files in a template's directory
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_read`

          - `cloudnet_rest:template_directory_list`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                properties:
                  files:
                    type: array
                    items:
                      $ref: '#/components/schemas/FileInfo'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/create:
    post:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Creates a template in a storage
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_create`
      responses:
        '204':
          description: The template was created
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/deploy:
    post:
      requestBody:
        required: true
        description: The content of the template in zip form
        content:
          application/zip:
            schema:
              type: object
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Deploys the zip archive into a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_deploy`
      responses:
        '204':
          description: The zip archive was deployed.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file/create:
    post:
      requestBody:
        required: true
        description: The content of the file
        content:
          '*':
            schema:
              type: object
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Creates/Overrides a file in a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_file_create`
      responses:
        '204':
          description: The file was deployed into the template.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file/append:
    post:
      requestBody:
        required: true
        description: The content of the file
        content:
          '*':
            schema:
              type: object
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Appends the content to a file in a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_file_append`
      responses:
        '204':
          description: The content was appended to the file in the template.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/directory/create:
    post:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Creates a directory in a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_directory_create`
      responses:
        '204':
          description: The directory was created in the respective template.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}:
    delete:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Deletes a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_delete`
      responses:
        '204':
          description: The template was deleted.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /template/{storage}/{prefix}/{name}/file:
    delete:
      parameters:
        - name: storage
          in: path
          required: true
          schema:
            type: string
        - name: prefix
          in: path
          required: true
          schema:
            type: string
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: path
          in: query
          required: true
          schema:
            type: string
      tags:
        - Templates
      summary: Deletes a file or directory from a template
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:template_write`

          - `cloudnet_rest:template_delete_file`
      responses:
        '204':
          description: The file was deleted from the template.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          description: The template does not exist
          $ref: '#/components/responses/Problem'
  /serviceVersion:
    get:
      tags:
        - Service Versions
      summary: Lists all available service version types
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_read`

          - `cloudnet_rest:service_version_list`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  serviceVersionTypes:
                    type: array
                    items:
                      $ref: '#/components/schemas/ServiceVersionType'
          description: Successful listing of available service version types
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    post:
      requestBody:
        required: true
        description: The service type to add to the service type provider
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceVersionType'
      tags:
        - Service Versions
      summary: Adds a service version type to the service type provider
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_write`

          - `cloudnet_rest:service_version_register`
      responses:
        '204':
          description: The service type was registered.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /serviceVersion/environment:
    get:
      tags:
        - Service Versions
      summary: Lists all available service environments
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_read`

          - `cloudnet_rest:service_version_list_environments`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  environments:
                    type: array
                    items:
                      $ref: '#/components/schemas/ServiceEnvironmentType'
          description: Successful listing of available service environments
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
    post:
      tags:
        - Service Versions
      summary: Adds a new service environment type to the service type provider
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_write`

          - `cloudnet_rest:service_version_environment`
      requestBody:
        required: true
        description: The service environment type to add to the service type provider
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceEnvironmentType'
      responses:
        '204':
          description: The service environment type was registered.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /serviceVersion/{version}:
    parameters:
      - name: version
        in: path
        required: true
        schema:
          type: string
    get:
      tags:
        - Service Versions
      summary: Get a specific service version type
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_read`

          - `cloudnet_rest:service_version_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceVersionType'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /serviceVersion/load:
    post:
      parameters:
        - name: url
          in: query
          required: false
          description: >
            The url to load the service types from. If no url is provided the
            service types

            loaded are the fallback types compiled into the jar file.
          schema:
            type: string
      tags:
        - Service Versions
      summary: Loads the service types into the service type provider
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:service_version_write`

          - `cloudnet_rest:service_version_load`
      responses:
        '204':
          description: Loaded the service versions successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /serviceVersion/install:
    post:
      parameters:
        - name: force
          description: Whether the install should be forced
          in: query
          schema:
            type: boolean
        - name: cache
          description: Whether the download files should be cached
          in: query
          schema:
            type: boolean
      tags:
        - Service Versions
      summary: Installs a service version to a static service or a service template
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - oneOf:
                    - properties:
                        staticService:
                          type: string
                          examples:
                            - Lobby-1
                    - properties:
                        template:
                          $ref: '#/components/schemas/ServiceTemplate'
                - oneOf:
                    - properties:
                        serviceVersionType:
                          type: string
                          examples:
                            - paper
                    - properties:
                        serviceVersionType:
                          $ref: '#/components/schemas/ServiceVersionType'
                - oneOf:
                    - properties:
                        serviceVersion:
                          type: string
                          examples:
                            - paper
                    - properties:
                        serviceVersion:
                          $ref: '#/components/schemas/ServiceVersion'
      responses:
        '204':
          description: Installed the service version to the static service / template.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /module/reload:
    post:
      tags:
        - Modules
      summary: Unloads and loads all loaded modules
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_reload_all`
      responses:
        '204':
          description: All modules were reloaded.
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /module/loaded:
    get:
      tags:
        - Modules
      summary: Gets all loaded modules
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_read`

          - `cloudnet_rest:module_list_loaded`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  modules:
                    type: array
                    items:
                      $ref: '#/components/schemas/ModuleInfo'
          description: Successfully listed all loaded modules
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /module/present:
    get:
      tags:
        - Modules
      summary: Gets all present module jar names
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_read`
        
          - `cloudnet_rest:module_list_present`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  modules:
                    type: array
                    items:
                      type: string
          description: Successfull listing of all module jar names
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /module/available:
    get:
      tags:
        - Modules
      summary: Gets all available modules the node knows about
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_read`

          - `cloudnet_rest:module_list_available`
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  modules:
                    type: array
                    items:
                      $ref: '#/components/schemas/ModuleEntry'
          description: Successful listing of all available modules
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
  /module/{name}:
    get:
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Modules
      summary: Get the information about a specific module
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_read`

          - `cloudnet_rest:module_get`
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModuleInfo'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /module/{name}/lifecycle:
    patch:
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: target
          in: query
          required: true
          schema:
            type: string
            enum:
              - start
              - reload
              - stop
              - unload
      tags:
        - Modules
      summary: Changes the lifecycle of a module
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_lifecycle`
      responses:
        '204':
          description: Tried to change the lifecycle of the module.
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /module/{name}/uninstall:
    post:
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Modules
      summary: Unloads and fully uninstalls a module
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_uninstall`
      responses:
        '204':
          description: The module was deleted successfully
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /module/{name}/load:
    post:
      requestBody:
        required: true
        description: The jar file of the module to copy and load
        content:
          application/java-archive:
            schema:
              type: object
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Modules
      summary: Copies a module from the request body and loads it
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_load`
        
        If the module already is available and just needs to be loaded do not provide the jar in the request body.
      responses:
        '201':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModuleInfo'
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /module/{name}/install:
    post:
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
        - name: checksumValidation
          in: query
          required: false
          description: Whether the checksum validation for official modules should be skipped
          schema:
            default: true
            type: boolean
        - name: start
          in: query
          required: false
          description: Whether the module should be started after installing and loading it
          schema:
            default: true
            type: boolean
      tags:
        - Modules
      summary: Installs a module to the node that is published in the official module repository
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_install`
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModuleInfo'
          description: The module was installed successfully
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
  /module/{name}/config:
    get:
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Modules
      summary: Get the configuration file of a module
      description: |
        Gets the configuration file of a module. Some module might not support this feature. In that case the response code is 400.
        
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_read`

          - `cloudnet_rest:module_config_get`
        
          - `cloudnet_rest:module_config_get_sensitive` for reading module configs with sensitive data.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
    put:
      requestBody:
        required: true
        description: The updated configuration file of the module
        content:
          application/json:
            schema:
              type: object
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      tags:
        - Modules
      summary: Updates the configuration file of a module
      description: |
        One of the following scopes is needed to execute the request:
          - `cloudnet_rest:module_write`

          - `cloudnet_rest:module_config_update`
      responses:
        '204':
          description: The module configuration was replaced
        '400':
          $ref: '#/components/responses/Problem'
        '401':
          $ref: '#/components/responses/Problem'
        '403':
          $ref: '#/components/responses/Problem'
        '404':
          $ref: '#/components/responses/Problem'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    basicAuth:
      type: http
      scheme: basic
  responses:
    Problem:
      description: The action couldn't be exececuted
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
  schemas:
    Problem:
      description: >-
        An object describing a problem as specific in RFC 9457. Note that this
        object can contain any number of additional properties depending on the
        called route and error cause.
      type: object
      properties:
        type:
          type: string
          format: uri
          description: An absolute URI that identifies the problem type
          default: about:blank
        title:
          type: string
          description: >-
            A short summary of the problem type. Written in English and readable
            for engineers (usually not suited for non technical stakeholders and
            not localized).
          examples:
            - Service Unavailable
        status:
          type: integer
          format: int32
          description: >-
            The HTTP status code generated by the origin server for this
            occurrence of the problem.
          minimum: 400
          exclusiveMaximum: 600
          examples:
            - 503
        detail:
          type: string
          description: >-
            A human-readable explanation specific to this occurrence of the
            problem
        instance:
          type: string
          format: uri
          description: >-
            An absolute URI reference that identifies the specific occurrence of
            the problem. It may or may not yield further information if
            dereferenced.
    NetworkClusterNode:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            uniqueId:
              type: string
              examples:
                - Node-1
            listeners:
              type: array
              items:
                $ref: '#/components/schemas/HostAndPort'
    NodeConfiguration:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            identity:
              $ref: '#/components/schemas/NetworkClusterNode'
            clusterConfig:
              type: object
              properties:
                clusterId:
                  type: string
                  examples:
                    - a0e8765e-7853-455b-bb2b-7a022a607be2
                nodes:
                  type: array
                  items:
                    $ref: '#/components/schemas/NetworkClusterNode'
            ipWhitelist:
              type: array
              items:
                type: string
              examples:
                - 192.168.56.1
                - 127.0.0.1
            maxCPUUsageToStartServices:
              type: number
              examples:
                - 90
            maxMemory:
              type: number
              examples:
                - 2048
            maxServiceConsoleLogCacheSize:
              type: integer
              examples:
                - 128
            processTerminationTimeoutSeconds:
              type: integer
              examples:
                - 5
            forceInitialClusterDataSync:
              type: boolean
              examples:
                - true
            printErrorStreamLinesFromServices:
              type: boolean
              examples:
                - true
            runBlockedServiceStartTryLaterAutomatic:
              type: boolean
              examples:
                - true
            jvmCommand:
              type: string
              examples:
                - java
            hostAddress:
              type: string
              examples:
                - 127.0.0.1
            connectHostAddress:
              type: string
              examples:
                - 127.0.0.1
            httpListeners:
              type: array
              items:
                $ref: '#/components/schemas/HostAndPort'
            clientSslConfig:
              $ref: '#/components/schemas/ConfigurationOptionSSL'
            serverSslConfig:
              $ref: '#/components/schemas/ConfigurationOptionSSL'
            webSslConfig:
              $ref: '#/components/schemas/ConfigurationOptionSSL'
    RestUser:
      type: object
      properties:
        id:
          type: string
          format: uuid
          examples:
            - 62b37d32-3305-475a-bf26-9abee4b0b90f
        username:
          type: string
          examples:
            - playo
          pattern: '^[a-zA-Z0-9]{4,16}'
        scopes:
          type: array
          items:
            type: string
          examples:
            - [ "cloudnet_rest:cluster_read", "cloudnet_rest:cluster_write" ]
        createdAt:
          type: string
          format: date
          examples:
            - 2024-06-02T20:28:46.3616543+02:00
        createdBy:
          type: string
          examples:
            - Console
        modifiedAt:
          type: string
          format: date
          examples:
            - 2024-06-02T20:28:46.3616543+02:00
        modifiedBy:
          type: string
          examples:
            - Console
    ConfigurationOptionSSL:
      type: object
      properties:
        enabled:
          type: boolean
          examples:
            - false
        clientAuth:
          type: boolean
          examples:
            - true
        trustCertificatePath:
          type: string
          examples:
            - null
        certificatePath:
          type: string
          examples:
            - local/certificate.pem
        privateKeyPath:
          type: string
          examples:
            - local/privateKey.key
    NodeServer:
      type: object
      properties:
        node:
          $ref: '#/components/schemas/NetworkClusterNode'
        state:
          type: string
          enum:
            - UNAVAILABLE
            - SYNCING
            - READY
            - DISCONNECTED
        head:
          type: boolean
          description: If the node server is the current head node.
        local:
          type: boolean
          description: If the node server is the node that handled the request.
        nodeInfoSnapshot:
          $ref: '#/components/schemas/NodeInfoSnapshot'

    NetworkClusterNodeInfoSnapshot:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            node:
              $ref: '#/components/schemas/NetworkClusterNode'
            state:
              type: string
              enum:
                - UNAVAILABLE
                - SYNCING
                - READY
                - DISCONNECTED
              examples:
                - READY
            head:
              type: boolean
              examples:
                - false
            local:
              type: boolean
              examples:
                - true
            nodeInfoSnapshot:
              $ref: '#/components/schemas/NodeInfoSnapshot'
    NodeInfoSnapshot:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            creationTime:
              type: integer
              description: The unix epoch millis when the snapshot was created
              examples:
                - 1620819600457
            startupMillis:
              type: integer
              description: The unix epoch millis when the node was started
              examples:
                - 1620819600457
            maxMemory:
              type: number
              description: The maximum memory amount (in MB) the node can consume
              examples:
                - 2048
            usedMemory:
              type: integer
              description: The memory (in MB) that is used by services on the node
              examples:
                - 512
            reservedMemory:
              type: integer
              description: The memory (in MB) that is reserved for services on the node
              examples:
                - 725
            currentServicesCount:
              type: integer
              description: The amount of services that are registered on the node
              examples:
                - 2
            drain:
              type: boolean
              description: Indicates if the node is draining (stopping after all running services were stopped)
              examples:
                - true
            node:
              $ref: '#/components/schemas/NetworkClusterNode'
            version:
              $ref: '#/components/schemas/CloudNetVersion'
            processSnapshot:
              $ref: '#/components/schemas/ProcessSnapshot'
            maxCPUUsageToStartServices:
              type: number
              examples:
                - 90.0
            modules:
              type: array
              items:
                $ref: '#/components/schemas/ModuleConfiguration'
    JwtToken:
      type: object
      properties:
        accessToken:
          $ref: '#/components/schemas/JwtTokenHolder'
        refreshToken:
          $ref: '#/components/schemas/JwtTokenHolder'
        creationTime:
          type: integer
    JwtTokenHolder:
      type: object
      properties:
        token:
          type: string
        tokenType:
          type: string
          examples:
            - access
        expiresIn:
          type: number
    JsonDocPropertyable:
      type: object
      properties:
        properties:
          type: object
          examples:
            - { }
    ServiceRemoteInclusion:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            url:
              type: string
              examples:
                - https://my-plugins.de/cool.jar
            destination:
              type: string
              examples:
                - plugins/cool.jar
    ServiceDeployment:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            template:
              $ref: '#/components/schemas/ServiceTemplate'
            excludes:
              type: array
              items:
                type: string
              examples:
                - [ 'spigot.jar', 'plugins/cool.jar' ]
    ServiceConfigurationBase:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            templates:
              type: array
              items:
                $ref: '#/components/schemas/ServiceTemplate'
            deployments:
              type: array
              items:
                $ref: '#/components/schemas/ServiceDeployment'
            includes:
              type: array
              items:
                $ref: '#/components/schemas/ServiceRemoteInclusion'
    GroupConfiguration:
      type: object
      allOf:
        - $ref: '#/components/schemas/ServiceConfigurationBase'
        - properties:
            name:
              type: string
              examples:
                - Lobby
            jvmOptions:
              type: array
              items:
                type: string
              examples:
                - [ Option1, Option2 ]
            processParameters:
              type: array
              items:
                type: string
              examples:
                - [ Parameter1, Parameter2 ]
            targetEnvironments:
              type: array
              items:
                type: string
              examples:
                - [ MINECRAFT_SERVER, VELOCITY ]
    CloudPlayer:
      type: object
      allOf:
        - $ref: '#/components/schemas/CloudOfflinePlayer'
        - properties:
            networkPlayerProxyInfo:
              $ref: '#/components/schemas/NetworkPlayerProxyInfo'
            connectedService:
              $ref: '#/components/schemas/NetworkServiceInfo'
            networkPlayerServerInfo:
              $ref: '#/components/schemas/NetworkPlayerServerInfo'
    CloudOfflinePlayer:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            name:
              type: string
              examples:
                - derklaro
            firstLoginTimeMillis:
              type: number
              examples:
                - 1642409856
            lastLoginTimeMillis:
              type: number
              examples:
                - 1642409856
            lastNetworkPlayerProxyInfo:
              $ref: '#/components/schemas/NetworkPlayerProxyInfo'
    NetworkPlayerServerInfo:
      type: object
      properties:
        uniqueId:
          type: string
          examples:
            - 05bf52c6-7bb0-4f13-8951-0e1fd803df35
        name:
          type: string
          examples:
            - taginbert
        xBoxId:
          type: string
          examples:
            - null
        address:
          $ref: '#/components/schemas/HostAndPort'
        networkService:
          $ref: '#/components/schemas/NetworkServiceInfo'
    NetworkPlayerProxyInfo:
      type: object
      allOf:
        - $ref: '#/components/schemas/NetworkPlayerServerInfo'
        - properties:
            version:
              type: integer
              examples:
                - 47
            listener:
              $ref: '#/components/schemas/HostAndPort'
            onlineMode:
              type: boolean
              examples:
                - true
    NetworkServiceInfo:
      type: object
      properties:
        groups:
          type: array
          items:
            type: string
        serviceId:
          $ref: '#/components/schemas/ServiceId'
    ServiceTemplate:
      type: object
      properties:
        prefix:
          type: string
          examples:
            - Global
        name:
          type: string
          examples:
            - server
        storage:
          type: string
          examples:
            - local
        priority:
          type: integer
          examples:
            - 5
        alwaysCopyToStaticServices:
          type: boolean
          examples:
            - false
    NodeInfo:
      type: object
      properties:
        version:
          $ref: '#/components/schemas/CloudNetVersion'
        nodeInfoSnapshot:
          $ref: '#/components/schemas/NetworkClusterNodeInfoSnapshot'
        lastNodeInfoSnapshot:
          $ref: '#/components/schemas/NetworkClusterNodeInfoSnapshot'
        serviceCount:
          type: integer
          examples:
            - 0
        clientConnections:
          type: array
          items:
            type: string
            examples:
              - 127.0.0.1:1411
              - 127.0.0.1:1412
    ProcessSnapshot:
      type: object
      properties:
        pid:
          type: integer
          examples:
            - 8168
        cpuUsage:
          type: number
          examples:
            - 0.7781862806132257
        systemCpuUsage:
          type: number
          examples:
            - 0.7781862806132257
        maxHeapMemory:
          type: number
          examples:
            - 2111832064
        heapUsageMemory:
          type: number
          examples:
            - 230091112
        noHeapUsageMemory:
          type: number
          examples:
            - 46906136
        unloadedClassCount:
          type: number
          examples:
            - 21
        totalLoadedClassCount:
          type: number
          examples:
            - 5940
        currentLoadedClassCount:
          type: number
          examples:
            - 5919
        threads:
          type: array
          items:
            $ref: '#/components/schemas/ThreadSnapshot'
    ThreadSnapshot:
      type: object
      properties:
        id:
          type: number
          examples:
            - 5
        priority:
          type: integer
          examples:
            - 1
        daemon:
          type: boolean
          examples:
            - true
        name:
          type: string
          examples:
            - WindowsStreamPump
        threadState:
          type: string
          enum:
            - NEW
            - RUNNABLE
            - BLOCKED
            - WAITING
            - TIMED_WAITING
            - TERMINATED
          examples:
            - RUNNABLE
    ModuleConfiguration:
      type: object
      properties:
        runtimeModule:
          type: boolean
          examples:
            - false
        storesSensitiveData:
          type: boolean
          examples:
            - true
        group:
          type: string
          examples:
            - eu.cloudnetservice.modules
        name:
          type: string
          examples:
            - CloudNet-CloudFlare
        version:
          type: string
          examples:
            - '1.1'
        main:
          type: string
          examples:
            - eu.cloudnetservice.modules.cloudflare.CloudNetCloudflareModule
        description:
          type: string
          examples:
            - Node extension for the https://cloudflare.com REST-API
        author:
          type: string
          examples:
            - CloudNetService
        website:
          type: string
          examples:
            - https://cloudnetservice.eu
        dataFolder:
          type: string
          examples:
            - null
        repositories:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                examples:
                  - CloudNet
              url:
                type: string
                examples:
                  - https://repo.cloudnetservice.eu/
        dependencies:
          type: array
          items:
            type: object
            properties:
              repo:
                type: string
                examples:
                  - CloudNet
              url:
                type: string
                examples:
                  - https://repo.cloudnetservice.eu/
              group:
                type: string
                examples:
                  - eu.cloudnetservice.cloudnet
              name:
                type: string
                examples:
                  - CloudNet-Bridge
              version:
                type: string
                examples:
                  - '1.1'
        minJavaVersionId:
          type: integer
          examples:
            - 11
        properties:
          type: object
          examples:
            - { }
    ProcessConfiguration:
      type: object
      properties:
        environment:
          type: string
          examples:
            - MINECRAFT_SERVER
        maxHeapMemorySize:
          type: integer
          examples:
            - 512
        jvmOptions:
          type: array
          items:
            type: string
          examples:
            - [ Option1, Option2 ]
        processParameters:
          type: array
          items:
            type: string
          examples:
            - [ Parameter1, Parameter2 ]
        environmentVariables:
          type: object
          additionalProperties:
            type: string
          examples:
            - MYSQL_PASSWORD: PASSWORD
    ServiceTask:
      type: object
      allOf:
        - $ref: '#/components/schemas/ServiceConfigurationBase'
        - properties:
            name:
              type: string
              examples:
                - Lobby
              pattern: ^[a-zA-Z0-9._\-*]*$
            runtime:
              type: string
              examples:
                - jvm
            javaCommand:
              type: string
              examples:
                - java
            nameSplitter:
              type: string
              examples:
                - '-'
            disableIpRewrite:
              type: boolean
              examples:
                - true
            maintenance:
              type: boolean
              examples:
                - false
            autoDeleteOnStop:
              type: boolean
              examples:
                - false
            staticServices:
              type: boolean
              examples:
                - true
            groups:
              type: array
              items:
                type: string
                examples:
                  - Lobby
            associatedNodes:
              type: array
              items:
                type: string
                examples:
                  - Node-1
            deletedFilesAfterStop:
              type: array
              items:
                type: string
              examples:
                - server.properties
                - plugins/cool/config.json
            processConfiguration:
              $ref: '#/components/schemas/ProcessConfiguration'
            startPort:
              type: integer
              examples:
                - 25565
            minServiceCount:
              type: integer
              examples:
                - 2
    ServiceId:
      type: object
      properties:
        taskName:
          type: string
          examples:
            - Lobby
        nameSplitter:
          type: string
          examples:
            - '-'
            - '-service-'
        environmentName:
          type: string
          examples:
            - MINECRAFT_SERVER
        allowedNodes:
          type: array
          items:
            type: string
          examples:
            - Node-1
            - Node-2
        uniqueId:
          type: string
          examples:
            - 43a9e824-cc3c-459b-b574-4f41e6509bda
        taskServiceId:
          type: integer
          examples:
            - 2
        nodeUniqueId:
          type: string
          examples:
            - Node-2
        environment:
          $ref: '#/components/schemas/ServiceEnvironmentType'
    ServiceConfiguration:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            retryConfiguration:
              $ref: '#/components/schemas/ServiceCreateRetryConfiguration'
            serviceId:
              $ref: '#/components/schemas/ServiceId'
            processConfig:
              $ref: '#/components/schemas/ProcessConfiguration'
            runtime:
              type: string
              examples:
                - jvm
            javaCommand:
              type: string
              examples:
                - java
            autoDeleteOnStop:
              type: boolean
              examples:
                - true
            staticService:
              type: boolean
              examples:
                - true
            groups:
              type: array
              items:
                type: string
              examples:
                - Lobby
                - Lobby-Global
            deletedFilesAfterStop:
              type: array
              items:
                type: string
              examples:
                - server.properties
                - plugins/cool/config.json
            templates:
              type: array
              items:
                $ref: '#/components/schemas/ServiceTemplate'
            deployments:
              type: array
              items:
                $ref: '#/components/schemas/ServiceDeployment'
            includes:
              type: array
              items:
                $ref: '#/components/schemas/ServiceRemoteInclusion'
            port:
              type: integer
              examples:
                - 25565
    ServiceInfoSnapshot:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            creationTime:
              type: number
              examples:
                - 1620824797570
            address:
              $ref: '#/components/schemas/HostAndPort'
            connectAddress:
              $ref: '#/components/schemas/HostAndPort'
            processSnapshot:
              $ref: '#/components/schemas/ProcessSnapshot'
            configuration:
              $ref: '#/components/schemas/ServiceConfiguration'
            connectedTime:
              type: number
              examples:
                - 1620824797599
            lifeCycle:
              type: string
              enum:
                - PREPARED
                - RUNNING
                - STOPPED
                - DELETED
              examples:
                - PREPARED
    ServiceCreateRetryConfiguration:
      type: object
      properties:
        maxRetries:
          type: integer
          examples:
            - 5
        backoffStrategy:
          type: array
          items:
            type: integer
            examples:
              - 500
              - 1500
        eventReceivers:
          type: object
    ServiceCreateResult:
      type: object
      properties:
        state:
          type: string
          enum:
            - CREATED
            - DEFERRED
            - FAILED
        creationId:
          type: string
          examples:
            - 43a9e824-cc3c-459b-b574-4f41e6509bda
        serviceInfo:
          $ref: '#/components/schemas/ServiceInfoSnapshot'
    HostAndPort:
      type: object
      properties:
        host:
          type: string
          examples:
            - 127.0.0.1
        port:
          type: integer
          examples:
            - 1410
    FileInfo:
      type: object
      properties:
        path:
          type: string
          examples:
            - plugins/cool.jar
        name:
          type: string
          examples:
            - cool.jar
        directory:
          type: boolean
          examples:
            - false
        hidden:
          type: boolean
          examples:
            - false
        creationTime:
          type: number
          examples:
            - 1619200785568
        lastModified:
          type: number
          examples:
            - 1619200785568
        lastAccess:
          type: number
          examples:
            - 1620804114355
        size:
          type: number
          examples:
            - 13785007
    ServiceVersion:
      type: object
      properties:
        name:
          type: string
          examples:
            - latest
        url:
          type: string
          examples:
            - https://api.papermc.io/v2/projects/paper/versions/1.14.4/builds/243/downloads/paper-1.14.4-243.jar
        minJavaVersion:
          type: integer
          examples:
            - 8
        maxJavaVersion:
          type: integer
          examples:
            - 11
        deprecated:
          type: boolean
          examples:
            - false
        cacheFiles:
          type: boolean
          examples:
            - false
        properties:
          type: object
          examples:
            - { }
        additionalDownloads:
          type: object
          additionalProperties:
            type: string
    ServiceVersionType:
      type: object
      properties:
        name:
          type: string
          examples:
            - paperspigot
        environmentType:
          type: string
          examples:
            - MINECRAFT_SERVER
        installSteps:
          type: array
          items:
            type: string
          examples:
            - DOWNLOAD
            - BUILD
            - UNZIP
            - COPY_FILTER
        versions:
          type: array
          items:
            $ref: '#/components/schemas/ServiceVersion'
    ServiceEnvironmentType:
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonDocPropertyable'
        - properties:
            name:
              type: string
              examples:
                - MINECRAFT_SERVER
            defaultServiceStartPort:
              type: integer
              examples:
                - 25565
            defaultProcessArguments:
              type: array
              items:
                type: string
              examples:
                - nogui
    ModuleInfo:
      type: object
      properties:
        lifecycle:
          type: string
          enum:
            - CREATED
            - LOADED
            - STARTED
            - RELOADING
            - STOPPED
            - UNLOADED
            - UNUSEABLE
        configuration:
          $ref: '#/components/schemas/ModuleConfiguration'
    ModuleEntry:
      type: object
      properties:
        official:
          type: boolean
          examples:
            - true
        name:
          type: string
          examples:
            - CloudNet-Bridge
        website:
          type: string
          examples:
            - cloudnetservice.eu
        version:
          type: string
          examples:
            - 4.0.0-RELEASE
        sha3256:
          type: string
          examples:
            - 786cd19b0b74dbaccf10736822db1ae330e1d8643caa490d1a3c2af3e143c113
        description:
          type: string
          examples:
            - A CloudNet module
        url:
          type: string
          examples:
            - https://github.com/%updateRepo%/raw/%updateBranch%/modules/cloudnet-s3.jar
        maintainers:
          type: array
          items:
            type: string
          examples:
            - Playo
            - Klaro
        releaseNotes:
          type: array
          items:
            type: string
        dependingModules:
          type: array
          items:
            type: string
          examples:
            - CloudNet-Bridge
            - CloudNet-Signs
    CloudNetVersion:
      type: object
      properties:
        major:
          type: integer
          examples:
            - 4
        minor:
          type: integer
          examples:
            - 0
        patch:
          type: integer
          examples:
            - 1
        revision:
          type: string
          examples:
            - 5dd7f63
        versionType:
          type: string
          examples:
            - RELEASE
        versionTitle:
          type: string
          examples:
            - Blizzard
